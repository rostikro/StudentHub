@page "/set-pasword"
@inject HttpClient Http
@inject NavigationManager Navigation

<h3>Login</h3>

<label>New password:</label>
<input @bind="password" type="password" />

<label>Confirm password:</label>
<input @bind="confirmPassword" type="password" />

<button @onclick="AttemptLogin">Login</button>

<p>@errorMessage</p>
@code {
    private string password = "";
    private string confirmPassword = "";
    private string errorMessage = "";

    private async Task AttemptLogin()
    {
        var loginRequest = new
        {
            ConfirmPassword = confirmPassword,
            Password = password,
        };

        var response = await Http.PostAsJsonAsync("https://localhost:7292/Users/login", loginRequest);

        if (response.IsSuccessStatusCode)
        {
            errorMessage = "";
            Navigation.NavigateTo("/");
        }
        else
        {
            errorMessage = "Login failed. Please check your email and password.";
        }
    }
}